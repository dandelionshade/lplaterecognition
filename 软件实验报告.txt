å¤©æ´¥ä»çˆ±å­¦é™¢æ™ºèƒ½è½¦ç‰Œè¯†åˆ«ç³»ç»Ÿ
è½¯ä»¶å®éªŒæŠ¥å‘Š

================================================================================
1. å®éªŒåŸºæœ¬ä¿¡æ¯
================================================================================

- **å®éªŒé¡¹ç›®åç§°**ï¼šå¤©æ´¥ä»çˆ±å­¦é™¢æ™ºèƒ½è½¦ç‰Œè¯†åˆ«ç³»ç»Ÿ
- **å¼€å‘è€…**ï¼šå¼ éœ‡
- **å®Œæˆæ—¥æœŸ**ï¼š2025å¹´7æœˆ12æ—¥
- **é¡¹ç›®ç‰ˆæœ¬**ï¼šv2.0
- **æ ¸å¿ƒæŠ€æœ¯æ ˆ**ï¼šPython, Flask, OpenCV, HTML5, CSS3, JavaScript

================================================================================
2. å®éªŒç›®æ ‡
================================================================================

æœ¬æ¬¡å®éªŒæ—¨åœ¨è®¾è®¡å¹¶å®ç°ä¸€ä¸ªåŠŸèƒ½å®Œå–„ã€æ€§èƒ½ç¨³å®šä¸”ç”¨æˆ·ä½“éªŒè‰¯å¥½çš„æ™ºèƒ½è½¦ç‰Œè¯†åˆ«Webåº”ç”¨ã€‚å…·ä½“ç›®æ ‡å¦‚ä¸‹ï¼š

1.  **æ„å»ºå®‰å…¨çš„è®¤è¯ç³»ç»Ÿ**ï¼šå®ç°ä¸€ä¸ªåŸºäºä¼šè¯çš„ç®¡ç†å‘˜ç™»å½•ç³»ç»Ÿï¼Œä¿æŠ¤æ ¸å¿ƒåŠŸèƒ½å’Œ4.3. **æ ¸å¿ƒåŠŸèƒ½å®ç°ç»†èŠ‚**

- **è½¦ç‰Œè¯†åˆ«å¢å¼º**ï¼šåœ¨è°ƒç”¨HyperLPR3æˆ–PaddleOCRä¹‹å‰ï¼Œä¼šå…ˆè°ƒç”¨`enhance_image_for_ocr`å‡½æ•°ã€‚è¯¥å‡½æ•°ç»¼åˆè¿ç”¨OpenCVçš„å¤šç§æŠ€æœ¯ï¼ˆå¦‚ç°åº¦åŒ–ã€å¯¹æ¯”åº¦å¢å¼ºCLAHEã€é”åŒ–ï¼‰å¯¹å›¾åƒè¿›è¡Œé¢„å¤„ç†ï¼Œæ˜¾è‘—æé«˜äº†åœ¨å¤æ‚å…‰ç…§æˆ–ä½åˆ†è¾¨ç‡æ¡ä»¶ä¸‹è½¦ç‰Œè¯†åˆ«çš„æˆåŠŸç‡å’Œå‡†ç¡®æ€§ã€‚

```python
def enhance_image_for_ocr(image, image_type='general'):
    """å›¾åƒå¢å¼ºå¤„ç†ï¼Œæé«˜OCRè¯†åˆ«ç‡"""
    try:
        # è½¬ä¸ºç°åº¦å›¾
        if len(image.shape) == 3:
            gray = cv2.cvtColor(image, cv2.COLOR_BGR2GRAY)  # BGRè½¬ç°åº¦
        else:
            gray = image.copy()  # å·²ç»æ˜¯ç°åº¦å›¾
            
        # ç›´æ–¹å›¾å‡è¡¡åŒ–å¢å¼ºå¯¹æ¯”åº¦
        enhanced = cv2.equalizeHist(gray)  # åº”ç”¨ç›´æ–¹å›¾å‡è¡¡åŒ–
        
        # å¦‚æœæ˜¯è½¦ç‰Œç±»å‹ï¼Œåº”ç”¨é¢å¤–çš„å¢å¼º
        if image_type == 'plate':
            # åº”ç”¨CLAHE (å¯¹æ¯”åº¦é™åˆ¶è‡ªé€‚åº”ç›´æ–¹å›¾å‡è¡¡åŒ–)
            clahe = cv2.createCLAHE(clipLimit=2.0, tileGridSize=(8,8))
            enhanced = clahe.apply(enhanced)  # å±€éƒ¨å¯¹æ¯”åº¦å¢å¼º
            
            # é”åŒ–æ»¤æ³¢
            kernel = np.array([[-1,-1,-1], [-1,9,-1], [-1,-1,-1]])  # é”åŒ–æ ¸
            enhanced = cv2.filter2D(enhanced, -1, kernel)  # åº”ç”¨é”åŒ–æ»¤æ³¢
            
            # è¾¹ç¼˜å¢å¼º
            enhanced = cv2.addWeighted(enhanced, 1.5, cv2.GaussianBlur(enhanced, (0,0), 10), -0.5, 0)
        
        # è½¬å›BGRæ ¼å¼ç”¨äºåç»­å¤„ç†
        if len(image.shape) == 3:
            result = cv2.cvtColor(enhanced, cv2.COLOR_GRAY2BGR)  # ç°åº¦è½¬BGR
        else:
            result = enhanced  # ä¿æŒç°åº¦æ ¼å¼
            
        return result
    except Exception as e:
        print(f"å›¾åƒå¢å¼ºå¤±è´¥: {e}")
        return image  # å¢å¼ºå¤±è´¥åˆ™è¿”å›åŸå›¾

def analyze_image_quality(image):
    """åˆ†æå›¾åƒè´¨é‡ï¼Œæä¾›æ”¹è¿›å»ºè®®"""
    try:
        # è½¬ä¸ºç°åº¦å›¾è¿›è¡Œåˆ†æ
        if len(image.shape) == 3:
            gray = cv2.cvtColor(image, cv2.COLOR_BGR2GRAY)  # å½©è‰²è½¬ç°åº¦
        else:
            gray = image.copy()  # å·²ç»æ˜¯ç°åº¦å›¾
        
        # è®¡ç®—å›¾åƒç»Ÿè®¡ä¿¡æ¯
        mean_brightness = np.mean(gray)    # å¹³å‡äº®åº¦
        std_brightness = np.std(gray)      # äº®åº¦æ ‡å‡†å·®(å¯¹æ¯”åº¦)
        
        # è®¡ç®—æ‹‰æ™®æ‹‰æ–¯æ–¹å·®ï¼ˆæ¨¡ç³Šåº¦æ£€æµ‹ï¼‰
        laplacian_var = cv2.Laplacian(gray, cv2.CV_64F).var()  # æ¸…æ™°åº¦è¯„ä¼°
        
        # å›¾åƒå°ºå¯¸
        height, width = gray.shape
        
        # è¯„ä¼°å’Œå»ºè®®
        suggestions = []
        quality_score = 100  # åˆå§‹è´¨é‡åˆ†æ•°
        
        # äº®åº¦è¯„ä¼°
        if mean_brightness < 50:
            suggestions.append('å›¾åƒè¿‡æš—ï¼Œå»ºè®®å¢åŠ å…‰ç…§')
            quality_score -= 20
        elif mean_brightness > 200:
            suggestions.append('å›¾åƒè¿‡äº®ï¼Œå»ºè®®å‡å°‘å…‰ç…§æˆ–è°ƒæ•´æ›å…‰')
            quality_score -= 15
            
        # æ¸…æ™°åº¦è¯„ä¼°
        if laplacian_var < 100:
            suggestions.append('å›¾åƒæ¨¡ç³Šï¼Œå»ºè®®é‡æ–°æ‹æ‘„æˆ–è¿›è¡Œé”åŒ–å¤„ç†')
            quality_score -= 25
            
        # å¯¹æ¯”åº¦è¯„ä¼°
        if std_brightness < 20:
            suggestions.append('å›¾åƒå¯¹æ¯”åº¦ä¸è¶³ï¼Œå»ºè®®è°ƒæ•´å…‰ç…§æ¡ä»¶')
            quality_score -= 15
            
        # åˆ†è¾¨ç‡è¯„ä¼°
        if width < 200 or height < 200:
            suggestions.append('å›¾åƒåˆ†è¾¨ç‡è¿‡ä½ï¼Œå»ºè®®ä½¿ç”¨æ›´é«˜åˆ†è¾¨ç‡çš„å›¾ç‰‡')
            quality_score -= 20
            
        return {
            'quality_score': max(quality_score, 0),  # ç¡®ä¿åˆ†æ•°ä¸ä¸ºè´Ÿ
            'brightness': mean_brightness,
            'contrast': std_brightness,
            'sharpness': laplacian_var,
            'resolution': f"{width}x{height}",
            'suggestions': suggestions
        }
        
    except Exception as e:
        print(f"å›¾åƒè´¨é‡åˆ†æå¤±è´¥: {e}")
        return {
            'quality_score': 50,
            'error': str(e),
            'suggestions': ['æ— æ³•åˆ†æå›¾åƒè´¨é‡ï¼Œè¯·æ£€æŸ¥å›¾åƒæ ¼å¼']
        }
```

- **ä½ç½®ä¿¡åº¦å¤„ç†**ï¼šå¯¹äºHyperLPR3è¿”å›çš„ä½ç½®ä¿¡åº¦ç»“æœï¼Œç³»ç»Ÿä¸ä¼šç›´æ¥ä¸¢å¼ƒï¼Œè€Œæ˜¯å°†å…¶æ ‡è®°ä¸º"ä½ç½®ä¿¡åº¦å€™é€‰"ï¼Œå¹¶é™ä½å…¶æƒé‡ï¼ŒåŒæ—¶åœ¨ç»“æœä¸­ç»™äºˆç”¨æˆ·æç¤ºã€‚è¿™ç§è®¾è®¡å…¼é¡¾äº†å¬å›ç‡å’Œå‡†ç¡®ç‡ã€‚

```python
# å¤„ç†HyperLPR3è¯†åˆ«ç»“æœçš„ä½ç½®ä¿¡åº¦é€»è¾‘
if plates and len(plates) > 0:
    plate_results = []      # æ­£å¸¸ç½®ä¿¡åº¦è½¦ç‰Œ
    low_confidence_plates = []  # ä½ç½®ä¿¡åº¦è½¦ç‰Œ
    
    for plate in plates:
        if plate and len(plate) >= 2:
            plate_no = str(plate[0])     # è½¦ç‰Œå·ç 
            confidence = float(plate[1])  # ç½®ä¿¡åº¦
            plate_info = {
                'text': plate_no,
                'confidence': confidence,
                'bbox': plate[2] if len(plate) > 2 else None  # è¾¹ç•Œæ¡†ä¿¡æ¯
            }
            
            if plate_no and confidence > 0.1:  # æ­£å¸¸ç½®ä¿¡åº¦é˜ˆå€¼
                plate_results.append(plate_info)
            elif plate_no and confidence > 0.05:  # ä½ç½®ä¿¡åº¦ä½†æœ‰å†…å®¹
                low_confidence_plates.append(plate_info)
    
    # å¤„ç†æ­£å¸¸ç½®ä¿¡åº¦è½¦ç‰Œ
    if plate_results:
        best_plate = max(plate_results, key=lambda x: x['confidence'])  # é€‰æ‹©æœ€ä½³ç»“æœ
        engine_result = {
            'engine': 'hyperlpr3',
            'text': best_plate['text'],
            'confidence': best_plate['confidence'],
            'plates': plate_results,
            'low_confidence_plates': low_confidence_plates,  # åŒ…å«ä½ç½®ä¿¡åº¦å€™é€‰
            'engine_available': True
        }
    # å¤„ç†åªæœ‰ä½ç½®ä¿¡åº¦è½¦ç‰Œçš„æƒ…å†µ
    elif low_confidence_plates:
        best_low_plate = max(low_confidence_plates, key=lambda x: x['confidence'])
        engine_result = {
            'engine': 'hyperlpr3_low_confidence',
            'text': best_low_plate['text'],
            'confidence': best_low_plate['confidence'] * 0.5,  # é™æƒå¤„ç†
            'low_confidence_plates': low_confidence_plates,
            'engine_available': True,
            'is_low_confidence': True,
            'suggestion': 'å»ºè®®æé«˜å›¾ç‰‡è´¨é‡æˆ–è°ƒæ•´å…‰ç…§æ¡ä»¶'
        }
```é—®æƒé™ã€‚
2.  **é›†æˆå¤šOCRè¯†åˆ«å¼•æ“**ï¼šæ•´åˆåŒ…æ‹¬HyperLPR3ï¼ˆä¸“ä¸šè½¦ç‰Œè¯†åˆ«ï¼‰ã€PaddleOCRï¼ˆé€šç”¨é«˜ç²¾åº¦è¯†åˆ«ï¼‰ã€Tesseractå’ŒEasyOCRï¼ˆå¤‡ç”¨ï¼‰åœ¨å†…çš„å¤šç§OCRå¼•æ“ï¼Œå¹¶å»ºç«‹æ™ºèƒ½è°ƒåº¦ä¸å®¹é”™æœºåˆ¶ã€‚
3.  **å®ç°é«˜çº§å›¾åƒå¤„ç†åŠŸèƒ½**ï¼šåŸºäºOpenCVæä¾›å¤šç§å®ç”¨çš„å›¾åƒé¢„å¤„ç†åŠŸèƒ½ï¼Œä»¥æé«˜è¯†åˆ«å‡†ç¡®ç‡ã€‚
4.  **å¼€å‘ç”¨æˆ·å‹å¥½çš„å‰ç«¯ç•Œé¢**ï¼šè®¾è®¡ä¸€ä¸ªç›´è§‚ã€å“åº”å¼çš„Webç•Œé¢ï¼Œæ”¯æŒå›¾åƒä¸Šä¼ ã€å®æ—¶é¢„è§ˆã€å‚æ•°é€‰æ‹©å’Œç»“æœå¯è§†åŒ–ã€‚
5.  **ç¡®ä¿ç³»ç»Ÿçš„å¥å£®æ€§å’Œå¯æ‰©å±•æ€§**ï¼šé‡‡ç”¨æ¨¡å—åŒ–è®¾è®¡ï¼Œå®ç°å®Œå–„çš„é”™è¯¯å¤„ç†ï¼Œä½¿ç³»ç»Ÿæ˜“äºç»´æŠ¤å’ŒåŠŸèƒ½æ‰©å±•ã€‚

================================================================================
3. å®éªŒç¯å¢ƒ
================================================================================

- **æ“ä½œç³»ç»Ÿ**ï¼šmacOS / Linux / Windows
- **ç¼–ç¨‹è¯­è¨€**ï¼šPython 3.9+
- **Webæ¡†æ¶**ï¼šFlask
- **æ ¸å¿ƒä¾èµ–åº“**ï¼š
    - `opencv-python`ï¼šç”¨äºæ ¸å¿ƒå›¾åƒå¤„ç†ã€‚
    - `hyperlpr3`ï¼šä¸“ä¸šè½¦ç‰Œè¯†åˆ«å¼•æ“ã€‚
    - `paddleocr` & `paddlepaddle`ï¼šç™¾åº¦å¼€æºOCRå¼•æ“ã€‚
    - `pytesseract`ï¼šTesseract OCRå¼•æ“æ¥å£ã€‚
    - `easyocr`ï¼šè½»é‡çº§OCRå¼•æ“ã€‚
    - `google-genai`ï¼šé›†æˆGemini AIè¿›è¡Œå¤šæ¨¡æ€åˆ†æã€‚
    - `Pillow`, `Numpy`ï¼šåŸºç¡€å›¾åƒä¸æ•°å€¼è®¡ç®—åº“ã€‚
- **å¼€å‘å·¥å…·**ï¼šVisual Studio Code

================================================================================
4. ç³»ç»Ÿè®¾è®¡ä¸å®ç°
================================================================================

4.1. **åç«¯è®¾è®¡ (Flask)**

åç«¯é‡‡ç”¨Flaskæ¡†æ¶æ„å»ºï¼Œå®ç°äº†æ¨¡å—åŒ–çš„RESTful APIæœåŠ¡ã€‚

- **é¡¹ç›®ç»“æ„**ï¼š
    - `main.py`ï¼šä¸»åº”ç”¨æ–‡ä»¶ï¼ŒåŒ…å«Flaskè·¯ç”±ã€ä¸šåŠ¡é€»è¾‘å’ŒAIå¼•æ“è°ƒåº¦ã€‚
    - `fallback_ocr.py`ï¼šå¤‡ç”¨OCRå®ç°ã€‚
    - `requirements.txt`ï¼šé¡¹ç›®ä¾èµ–ã€‚
    - `web/`ï¼šå­˜æ”¾æ‰€æœ‰å‰ç«¯é™æ€æ–‡ä»¶ã€‚
    - `uploads/`ï¼šä¸´æ—¶å­˜æ”¾ä¸Šä¼ çš„å›¾ç‰‡ã€‚

- **æ ¸å¿ƒä»£ç å®ç°**ï¼š

```python
# Flaskåº”ç”¨åˆå§‹åŒ–å’Œé…ç½®
from flask import Flask, jsonify, request, session, redirect, url_for
import hashlib
import os

app = Flask(__name__)  # åˆ›å»ºFlaskåº”ç”¨å®ä¾‹
app.secret_key = os.environ.get('SECRET_KEY', 'tianjin_renai_college_plate_recognition_2025')  # è®¾ç½®ä¼šè¯å¯†é’¥

# ç®¡ç†å‘˜é…ç½®
ADMIN_USERNAME = 'admin'  # ç®¡ç†å‘˜ç”¨æˆ·å
ADMIN_PASSWORD_HASH = hashlib.sha256('admin'.encode()).hexdigest()  # å¯†ç å“ˆå¸Œå­˜å‚¨

# ç™»å½•è®¤è¯è£…é¥°å™¨
from functools import wraps
def login_required(f):
    @wraps(f)
    def decorated_function(*args, **kwargs):
        if 'logged_in' not in session:  # æ£€æŸ¥ç”¨æˆ·æ˜¯å¦å·²ç™»å½•
            return redirect(url_for('login'))  # æœªç™»å½•åˆ™é‡å®šå‘åˆ°ç™»å½•é¡µ
        return f(*args, **kwargs)  # å·²ç™»å½•åˆ™ç»§ç»­æ‰§è¡ŒåŸå‡½æ•°
    return decorated_function

# OCRå¼•æ“åˆå§‹åŒ–ç³»ç»Ÿ
ocr_engines = {}  # å…¨å±€å¼•æ“å­—å…¸
def init_ocr_engines():
    """å»¶è¿Ÿåˆå§‹åŒ–OCRå¼•æ“ï¼Œé¿å…å¯åŠ¨æ—¶é”™è¯¯"""
    global ocr_engines, PADDLEOCR_AVAILABLE, HYPERLPR_AVAILABLE
    
    # PaddleOCRåˆå§‹åŒ–
    if PADDLEOCR_AVAILABLE and PaddleOCR is not None and 'paddleocr' not in ocr_engines:
        try:
            ocr_engines['paddleocr'] = PaddleOCR(lang='ch', show_log=False)  # åˆ›å»ºä¸­æ–‡OCRå®ä¾‹
            print("âœ… PaddleOCR åˆå§‹åŒ–æˆåŠŸ")
        except Exception as e:
            print(f"âŒ PaddleOCR åˆå§‹åŒ–å¤±è´¥: {e}")
            PADDLEOCR_AVAILABLE = False
    
    # HyperLPR3è½¦ç‰Œè¯†åˆ«å¼•æ“åˆå§‹åŒ–
    if HYPERLPR_AVAILABLE and lpr3 is not None and 'hyperlpr3' not in ocr_engines:
        try:
            ocr_engines['hyperlpr3'] = lpr3.LicensePlateCatcher()  # åˆ›å»ºè½¦ç‰Œè¯†åˆ«å®ä¾‹
            print("âœ… HyperLPR3 åˆå§‹åŒ–æˆåŠŸ")
        except Exception as e:
            print(f"âŒ HyperLPR3 åˆå§‹åŒ–å¤±è´¥: {e}")
            HYPERLPR_AVAILABLE = False
```

- **æ ¸å¿ƒAPIå®ç°**ï¼š
    - `POST /api/ocr-simple`ï¼šè¿™æ˜¯ç³»ç»Ÿçš„æ ¸å¿ƒè¯†åˆ«æ¥å£ã€‚å®ƒæ¥æ”¶Base64ç¼–ç çš„å›¾åƒå’ŒæŒ‡å®šçš„å¼•æ“ï¼Œå†…éƒ¨å®ç°äº†ä¸€å¥—å¤æ‚çš„æ™ºèƒ½è°ƒåº¦é€»è¾‘ï¼š

```python
@app.route("/api/ocr-simple", methods=["POST"])
def ocr_simple_api():
    """å¢å¼ºçš„OCRè¯†åˆ«APIï¼Œç¡®ä¿æ ¸å¿ƒåŠŸèƒ½å¯ç”¨ - å¤šå¼•æ“å¤‡ç”¨ç³»ç»Ÿ"""
    try:
        data = request.get_json()  # è·å–JSONè¯·æ±‚æ•°æ®
        image_base64 = data.get('image')  # æå–base64å›¾åƒæ•°æ®
        engine = data.get('engine', 'auto')  # è·å–æŒ‡å®šå¼•æ“ï¼Œé»˜è®¤è‡ªåŠ¨é€‰æ‹©
        
        if not image_base64:  # éªŒè¯æ˜¯å¦æä¾›äº†å›¾åƒæ•°æ®
            return jsonify({"error": "æ²¡æœ‰æä¾›å›¾åƒæ•°æ®"}), 400
        
        # è½¬æ¢ä¸ºOpenCVå›¾åƒæ ¼å¼
        image_data = base64.b64decode(image_base64)  # è§£ç base64æ•°æ®
        nparr = np.frombuffer(image_data, np.uint8)  # è½¬æ¢ä¸ºnumpyæ•°ç»„
        image = cv2.imdecode(nparr, cv2.IMREAD_COLOR)  # è§£ç ä¸ºOpenCVå›¾åƒ
        
        # å›¾åƒè´¨é‡åˆ†æ
        image_quality = analyze_image_quality(image)  # åˆ†æå›¾åƒè´¨é‡
        print(f"ğŸ“Š å›¾åƒè´¨é‡è¯„åˆ†: {image_quality['quality_score']}/100")
        
        # æ™ºèƒ½å¼•æ“é€‰æ‹©ç­–ç•¥
        def get_engines_priority(requested_engine):
            if requested_engine == 'auto':  # è‡ªåŠ¨æ¨¡å¼
                return ['hyperlpr3', 'paddleocr', 'easyocr', 'tesseract', 'fallback']
            elif requested_engine == 'hyperlpr3':  # è½¦ç‰Œè¯†åˆ«ä¼˜å…ˆ
                return ['hyperlpr3', 'paddleocr', 'easyocr', 'tesseract', 'fallback']
            elif requested_engine == 'paddleocr':  # é€šç”¨OCRä¼˜å…ˆ
                return ['paddleocr', 'easyocr', 'tesseract', 'hyperlpr3', 'fallback']
            else:  # Tesseractä¼˜å…ˆ
                return ['tesseract', 'paddleocr', 'easyocr', 'hyperlpr3', 'fallback']
        
        engines_to_try = get_engines_priority(engine)  # è·å–å¼•æ“ä¼˜å…ˆçº§é˜Ÿåˆ—
        best_result = None  # å­˜å‚¨æœ€ä½³è¯†åˆ«ç»“æœ
        best_confidence = 0  # å­˜å‚¨æœ€é«˜ç½®ä¿¡åº¦
        
        # å¤šå¼•æ“å¾ªç¯è¯†åˆ«
        for engine_name in engines_to_try:
            try:
                engine_result = None
                
                # HyperLPR3ä¸“ä¸šè½¦ç‰Œè¯†åˆ«
                if engine_name == 'hyperlpr3' and HYPERLPR_AVAILABLE and 'hyperlpr3' in ocr_engines:
                    catcher = ocr_engines['hyperlpr3']  # è·å–è½¦ç‰Œè¯†åˆ«å¼•æ“
                    enhanced_image = enhance_image_for_ocr(image, 'plate')  # å›¾åƒé¢„å¤„ç†å¢å¼º
                    rgb_image = cv2.cvtColor(enhanced_image, cv2.COLOR_BGR2RGB)  # è½¬æ¢ä¸ºRGBæ ¼å¼
                    plates = catcher(rgb_image)  # æ‰§è¡Œè½¦ç‰Œè¯†åˆ«
                    
                    if plates and len(plates) > 0:  # æ£€æŸ¥æ˜¯å¦è¯†åˆ«åˆ°è½¦ç‰Œ
                        plate_results = []
                        for plate in plates:
                            if plate and len(plate) >= 2:
                                plate_no = str(plate[0])  # è½¦ç‰Œå·ç 
                                confidence = float(plate[1])  # ç½®ä¿¡åº¦
                                if plate_no and confidence > 0.1:
                                    plate_results.append({
                                        'text': plate_no,
                                        'confidence': confidence
                                    })
                        
                        if plate_results:
                            best_plate = max(plate_results, key=lambda x: x['confidence'])  # é€‰æ‹©æœ€é«˜ç½®ä¿¡åº¦ç»“æœ
                            engine_result = {
                                'engine': 'hyperlpr3',
                                'text': best_plate['text'],
                                'confidence': best_plate['confidence'],
                                'plates': plate_results,
                                'engine_available': True
                            }
                            print(f"âœ… HyperLPR3è¯†åˆ«æˆåŠŸ: {best_plate['text']} (ç½®ä¿¡åº¦: {best_plate['confidence']:.2f})")
                
                # PaddleOCRé€šç”¨è¯†åˆ«
                elif engine_name == 'paddleocr' and PADDLEOCR_AVAILABLE and 'paddleocr' in ocr_engines:
                    paddle_results = ocr_engines['paddleocr'].ocr(image)  # æ‰§è¡ŒOCRè¯†åˆ«
                    
                    if paddle_results and paddle_results[0]:
                        texts = []
                        confidences = []
                        
                        for line in paddle_results[0]:  # éå†è¯†åˆ«ç»“æœ
                            if line and len(line) >= 2 and line[1][1] > 0.3:  # ç½®ä¿¡åº¦é˜ˆå€¼è¿‡æ»¤
                                text = line[1][0].strip()  # æå–æ–‡æœ¬
                                conf = line[1][1]  # æå–ç½®ä¿¡åº¦
                                texts.append(text)
                                confidences.append(conf)
                        
                        if texts:
                            full_text = ''.join(texts).replace(' ', '')  # åˆå¹¶æ–‡æœ¬å¹¶å»é™¤ç©ºæ ¼
                            avg_confidence = sum(confidences) / len(confidences)  # è®¡ç®—å¹³å‡ç½®ä¿¡åº¦
                            
                            # è½¦ç‰Œæ ¼å¼æ£€æŸ¥åŠ åˆ†
                            import re
                            plate_pattern = r'[äº¬æ´¥æ²ªæ¸å†€è±«äº‘è¾½é»‘æ¹˜çš–é²æ–°è‹æµ™èµ£é„‚æ¡‚ç”˜æ™‹è’™é™•å‰é—½è´µç²¤é’è—å·å®ç¼ä½¿é¢†][A-Z][A-Z0-9]{4,5}'
                            if re.search(plate_pattern, full_text):  # åŒ¹é…è½¦ç‰Œæ ¼å¼
                                avg_confidence = min(avg_confidence + 0.3, 1.0)  # æ ¼å¼åŒ¹é…å¥–åŠ±
                            
                            engine_result = {
                                'engine': 'paddleocr',
                                'text': full_text,
                                'confidence': avg_confidence,
                                'texts': texts,
                                'individual_confidences': confidences,
                                'engine_available': True
                            }
                            print(f"âœ… PaddleOCRè¯†åˆ«æˆåŠŸ: {full_text} (ç½®ä¿¡åº¦: {avg_confidence:.2f})")
                
                # è¯„ä¼°å½“å‰å¼•æ“ç»“æœ
                if engine_result and engine_result.get('confidence', 0) > best_confidence:
                    best_result = engine_result  # æ›´æ–°æœ€ä½³ç»“æœ
                    best_confidence = engine_result['confidence']
                    
                    # å¦‚æœç½®ä¿¡åº¦è¶³å¤Ÿé«˜ï¼Œæå‰è¿”å›ç»“æœ
                    if best_confidence > 0.7:
                        print(f"ğŸ¯ é«˜ç½®ä¿¡åº¦ç»“æœï¼Œæå‰è¿”å›: {engine_result['text']}")
                        break
                        
            except Exception as e:
                print(f"ğŸ’¥ å¼•æ“ {engine_name} è¿è¡Œå¤±è´¥: {e}")
                continue
        
        # è¿”å›æœ€ä½³ç»“æœ
        if best_result and best_result.get('text'):
            return jsonify({
                "success": True,
                "engine": best_result['engine'],
                "text": best_result['text'],
                "confidence": best_result['confidence'],
                "results": best_result,
                "image_quality": image_quality,
                "message": f"ä½¿ç”¨ {best_result['engine']} å¼•æ“è¯†åˆ«æˆåŠŸ"
            })
        else:
            return jsonify({
                "success": False,
                "engine": "fallback",
                "error": "æ‰€æœ‰OCRå¼•æ“è¯†åˆ«å¤±è´¥",
                "image_quality": image_quality,
                "suggestion": "è¯·æ£€æŸ¥å›¾ç‰‡è´¨é‡æˆ–è°ƒæ•´å…‰ç…§æ¡ä»¶"
            })
            
    except Exception as e:
        return jsonify({
            "success": False,
            "error": f"ç³»ç»Ÿé”™è¯¯: {str(e)}"
        }), 500
```

        1.  **å›¾åƒè´¨é‡åˆ†æ**ï¼šé¦–å…ˆå¯¹å›¾åƒè¿›è¡Œæ¸…æ™°åº¦ã€äº®åº¦ç­‰ç»´åº¦çš„åˆ†æã€‚
        2.  **å¼•æ“ä¼˜å…ˆçº§é˜Ÿåˆ—**ï¼šæ ¹æ®ç”¨æˆ·é€‰æ‹©ï¼ˆæˆ–`auto`æ¨¡å¼ï¼‰åˆ›å»ºä¸€ä¸ªå¼•æ“è°ƒç”¨é˜Ÿåˆ—ï¼Œå¦‚ `['hyperlpr3', 'paddleocr', ...]`ã€‚
        3.  **å¾ªç¯è°ƒç”¨ä¸å®¹é”™**ï¼šéå†é˜Ÿåˆ—ï¼Œä¾æ¬¡è°ƒç”¨OCRå¼•æ“ã€‚ä½¿ç”¨`try-except`å—åŒ…è£¹æ¯ä¸ªå¼•æ“çš„è°ƒç”¨ï¼Œç¡®ä¿å•ä¸ªå¼•æ“çš„å¤±è´¥ä¸ä¼šä¸­æ–­æ•´ä¸ªè¯†åˆ«æµç¨‹ã€‚
        4.  **ç»“æœè¯„ä¼°**ï¼šå¯¹æ¯ä¸ªå¼•æ“è¿”å›çš„ç»“æœè¿›è¡Œç½®ä¿¡åº¦è¯„ä¼°ã€‚å¦‚æœæŸä¸ªå¼•æ“è¿”å›çš„ç»“æœç½®ä¿¡åº¦é«˜äºé¢„è®¾é˜ˆå€¼ï¼ˆå¦‚0.7ï¼‰ï¼Œåˆ™æå‰ç»ˆæ­¢å¾ªç¯ï¼Œè¿”å›è¯¥ç»“æœã€‚
        5.  **æœ€ä½³ç»“æœé€‰æ‹©**ï¼šå¦‚æœæ‰€æœ‰å¼•æ“éƒ½æ‰§è¡Œå®Œæ¯•ï¼Œåˆ™é€‰æ‹©å…¶ä¸­ç½®ä¿¡åº¦æœ€é«˜çš„ç»“æœä½œä¸ºæœ€ç»ˆè¾“å‡ºã€‚
    - `POST /login`, `GET /logout`, `GET /admin`ï¼šå®ç°äº†å®Œæ•´çš„ç”¨æˆ·è®¤è¯æµç¨‹ï¼Œä½¿ç”¨Flask `session`æ¥ç®¡ç†ç”¨æˆ·ç™»å½•çŠ¶æ€ã€‚

```python
# ç™»å½•é¡µé¢å¤„ç†
@app.route("/login", methods=["GET", "POST"])
def login():
    """ç®¡ç†å‘˜ç™»å½•é¡µé¢"""
    if request.method == "POST":
        username = request.form.get('username')  # è·å–ç”¨æˆ·å
        password = request.form.get('password')  # è·å–å¯†ç 
        
        # éªŒè¯ç”¨æˆ·åå’Œå¯†ç 
        if username == ADMIN_USERNAME and hashlib.sha256(password.encode()).hexdigest() == ADMIN_PASSWORD_HASH:
            session['logged_in'] = True  # è®¾ç½®ç™»å½•çŠ¶æ€
            session['username'] = username  # ä¿å­˜ç”¨æˆ·ååˆ°ä¼šè¯
            return redirect(url_for('admin_dashboard'))  # é‡å®šå‘åˆ°ç®¡ç†é¢æ¿
        else:
            return render_template_string(LOGIN_TEMPLATE, error="ç”¨æˆ·åæˆ–å¯†ç é”™è¯¯")  # è¿”å›é”™è¯¯ä¿¡æ¯
    
    return render_template_string(LOGIN_TEMPLATE)  # æ˜¾ç¤ºç™»å½•è¡¨å•

# ç®¡ç†å‘˜ä»ªè¡¨ç›˜
@app.route("/admin")
@login_required  # éœ€è¦ç™»å½•æƒé™
def admin_dashboard():
    """ç®¡ç†å‘˜ä»ªè¡¨ç›˜"""
    return render_template_string(ADMIN_DASHBOARD_TEMPLATE, username=session.get('username'))

# ç™»å‡ºåŠŸèƒ½
@app.route("/logout")
def logout():
    """ç®¡ç†å‘˜ç™»å‡º"""
    session.clear()  # æ¸…é™¤æ‰€æœ‰ä¼šè¯æ•°æ®
    return redirect(url_for('login'))  # é‡å®šå‘åˆ°ç™»å½•é¡µé¢
```

    - `GET /api/ocr-engines`ï¼šå®æ—¶è¿”å›åç«¯å„OCRå¼•æ“çš„å¯ç”¨çŠ¶æ€ï¼Œä¾›å‰ç«¯åŠ¨æ€å±•ç¤ºã€‚

```python
@app.route("/api/ocr-engines", methods=["GET"])
def get_ocr_engines():
    """è·å–å¯ç”¨çš„OCRå¼•æ“åˆ—è¡¨"""
    init_ocr_engines()  # ç¡®ä¿å¼•æ“å·²åˆå§‹åŒ–
    
    engines = {}
    
    # æ£€æŸ¥PaddleOCRå¯ç”¨æ€§
    if PADDLEOCR_AVAILABLE and 'paddleocr' in ocr_engines:
        engines['paddleocr'] = {
            'name': 'PaddleOCR',
            'description': 'ç™¾åº¦å¼€æº OCRï¼Œæ”¯æŒä¸­è‹±æ–‡è¯†åˆ«',
            'available': True
        }
    else:
        engines['paddleocr'] = {
            'name': 'PaddleOCR',
            'description': 'ç™¾åº¦å¼€æº OCRï¼Œæ”¯æŒä¸­è‹±æ–‡è¯†åˆ«',
            'available': False,
            'error': 'PaddleOCR æœªå®‰è£…æˆ–åˆå§‹åŒ–å¤±è´¥'
        }
    
    # æ£€æŸ¥HyperLPR3å¯ç”¨æ€§
    if HYPERLPR_AVAILABLE and 'hyperlpr3' in ocr_engines:
        engines['hyperlpr3'] = {
            'name': 'HyperLPR3',
            'description': 'ä¸“é—¨çš„è½¦ç‰Œè¯†åˆ«å¼•æ“',
            'available': True
        }
    else:
        engines['hyperlpr3'] = {
            'name': 'HyperLPR3',
            'description': 'ä¸“é—¨çš„è½¦ç‰Œè¯†åˆ«å¼•æ“',
            'available': False,
            'error': 'HyperLPR3 æœªå®‰è£…æˆ–åˆå§‹åŒ–å¤±è´¥'
        }
    
    # æ£€æŸ¥Tesseractå¯ç”¨æ€§
    if TESSERACT_AVAILABLE:
        engines['tesseract'] = {
            'name': 'Tesseract OCR',
            'description': 'ä¼ ç»Ÿ OCR å¼•æ“ï¼Œæ”¯æŒå¤šç§è¯­è¨€',
            'available': True
        }
    else:
        engines['tesseract'] = {
            'name': 'Tesseract OCR',
            'description': 'ä¼ ç»Ÿ OCR å¼•æ“ï¼Œæ”¯æŒå¤šç§è¯­è¨€',
            'available': False,
            'error': 'Tesseract æœªå®‰è£…'
        }
    
    return jsonify({
        "engines": engines,
        "total": len(engines),
        "available": len([e for e in engines.values() if e['available']])  # ç»Ÿè®¡å¯ç”¨å¼•æ“æ•°é‡
    })
```

4.2. **å‰ç«¯è®¾è®¡ (HTML/CSS/JS)**

å‰ç«¯æ—¨åœ¨æä¾›ä¸€ä¸ªåŠŸèƒ½å¼ºå¤§ä¸”æ˜“äºæ“ä½œçš„å•é¡µåº”ç”¨ï¼ˆSPAï¼‰ã€‚

- **é¡µé¢å¸ƒå±€ (`ocr.html`)**ï¼š
    - é‡‡ç”¨ç°ä»£åŒ–çš„æ ‡ç­¾é¡µï¼ˆTabsï¼‰è®¾è®¡ï¼Œå°†**Gemini AIåˆ†æ**ã€**é€šç”¨OCRè¯†åˆ«**ã€**ä¸“ä¸šè½¦ç‰Œè¯†åˆ«**å’Œ**å›¾åƒå¤„ç†**å››å¤§åŠŸèƒ½æ¸…æ™°åœ°åˆ†éš”å¼€ã€‚
    - é¡µé¢å¸ƒå±€é‡‡ç”¨å“åº”å¼è®¾è®¡ï¼Œé€‚é…ä¸åŒå°ºå¯¸çš„å±å¹•ã€‚

- **æ ¸å¿ƒHTMLç»“æ„**ï¼š

```html
<!-- æ ‡ç­¾å¯¼èˆªæ  -->
<nav class="tab-nav">
  <button class="tab-btn active" data-tab="gemini">
    <i class="fas fa-brain"></i> Gemini AIåˆ†æ
  </button>
  <button class="tab-btn" data-tab="ocr">
    <i class="fas fa-font"></i> é€šç”¨OCRè¯†åˆ«
  </button>
  <button class="tab-btn" data-tab="plate">
    <i class="fas fa-car"></i> ä¸“ä¸šè½¦ç‰Œè¯†åˆ«
  </button>
  <button class="tab-btn" data-tab="process">
    <i class="fas fa-cogs"></i> å›¾åƒå¤„ç†
  </button>
</nav>

<!-- OCRè¯†åˆ«æ ‡ç­¾é¡µå†…å®¹ -->
<div id="ocr" class="tab-content">
  <div class="panel">
    <h3><i class="fas fa-font"></i> é€šç”¨OCRæ–‡å­—è¯†åˆ«</h3>
    <!-- å›¾ç‰‡ä¸Šä¼ åŒºåŸŸ -->
    <div class="image-input-section">
      <div class="upload-section">
        <label for="ocr-upload" class="upload-btn">
          <i class="fas fa-upload"></i> ä¸Šä¼ å›¾ç‰‡
        </label>
        <input type="file" id="ocr-upload" accept="image/*" style="display: none;">
        <div id="ocr-preview" class="image-preview"></div>  <!-- å›¾ç‰‡é¢„è§ˆåŒº -->
      </div>
    </div>
    
    <!-- å¼•æ“é€‰æ‹©åŒºåŸŸ -->
    <div class="engine-selection">
      <label>é€‰æ‹© OCR å¼•æ“ï¼š</label>
      <div class="engine-options">
        <label class="engine-option">
          <input type="radio" name="ocr-engine" value="paddleocr" checked>
          <span>PaddleOCR</span>  <!-- ç™¾åº¦OCRå¼•æ“ -->
        </label>
        <label class="engine-option">
          <input type="radio" name="ocr-engine" value="tesseract">
          <span>Tesseract</span>  <!-- ä¼ ç»ŸOCRå¼•æ“ -->
        </label>
      </div>
    </div>
    
    <!-- æ“ä½œæŒ‰é’® -->
    <div class="action-section">
      <button id="ocr-recognize" class="action-btn" disabled>
        <i class="fas fa-search"></i> å¼€å§‹è¯†åˆ«
      </button>
    </div>
    
    <!-- ç»“æœæ˜¾ç¤ºåŒºåŸŸ -->
    <div class="result-section">
      <h4>è¯†åˆ«ç»“æœï¼š</h4>
      <div id="ocr-result" class="result-box">è¯·å…ˆä¸Šä¼ å›¾ç‰‡</div>
    </div>
  </div>
</div>
```

- **äº¤äº’é€»è¾‘ (`ocr-main.js`)**ï¼š

```javascript
// å…¨å±€å˜é‡å®šä¹‰
let currentImages = {
  gemini: null,    // Geminiåˆ†æå›¾ç‰‡
  ocr: null,       // OCRè¯†åˆ«å›¾ç‰‡
  plate: null,     // è½¦ç‰Œè¯†åˆ«å›¾ç‰‡
  process: null    // å›¾åƒå¤„ç†å›¾ç‰‡
};
let enginesStatus = {};  // OCRå¼•æ“çŠ¶æ€
let recognitionHistory = [];  // è¯†åˆ«å†å²è®°å½•

// é«˜çº§Toasté€šçŸ¥ç³»ç»Ÿ
function showToast(message, type = 'info', options = {}) {
  const {
    duration = getDefaultDuration(type),  // æ ¹æ®ç±»å‹è®¾ç½®é»˜è®¤æŒç»­æ—¶é—´
    showProgressBar = false,              // æ˜¯å¦æ˜¾ç¤ºè¿›åº¦æ¡
    position = 'top-right',               // æ˜¾ç¤ºä½ç½®
    closable = true,                      // æ˜¯å¦å¯å…³é—­
    icon = getDefaultIcon(type)           // æ ¹æ®ç±»å‹è®¾ç½®å›¾æ ‡
  } = options;

  // åˆ›å»ºtoastå®¹å™¨
  const toast = document.createElement('div');
  toast.className = `toast toast-${type}`;  // è®¾ç½®CSSç±»å
  toast.style.cssText = `
    position: fixed;
    ${getPositionStyles(position)}        /* è®¾ç½®ä½ç½®æ ·å¼ */
    background: ${getBackgroundColor(type)};  /* æ ¹æ®ç±»å‹è®¾ç½®èƒŒæ™¯è‰² */
    color: ${getTextColor(type)};         /* æ ¹æ®ç±»å‹è®¾ç½®æ–‡å­—é¢œè‰² */
    padding: 16px 20px;                   /* å†…è¾¹è· */
    border-radius: 12px;                  /* åœ†è§’ */
    box-shadow: 0 8px 32px rgba(0, 0, 0, 0.15);  /* é˜´å½±æ•ˆæœ */
    backdrop-filter: blur(10px);          /* èƒŒæ™¯æ¨¡ç³Šæ•ˆæœ */
    z-index: 10003;                       /* å±‚çº§ */
    opacity: 0;                           /* åˆå§‹é€æ˜ */
    transform: translateX(${position.includes('right') ? '100%' : '-100%'}) scale(0.8);  /* åˆå§‹ä½ç½®å’Œç¼©æ”¾ */
    transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);  /* è¿‡æ¸¡åŠ¨ç”» */
  `;

  // æ˜¾ç¤ºtoaståŠ¨ç”»
  setTimeout(() => {
    toast.style.opacity = '1';            // è®¾ç½®é€æ˜åº¦ä¸ºå®Œå…¨ä¸é€æ˜
    toast.style.transform = 'translateX(0) scale(1)';  // ç§»åŠ¨åˆ°æœ€ç»ˆä½ç½®å¹¶æ¢å¤æ­£å¸¸å¤§å°
  }, 10);

  document.body.appendChild(toast);       // æ·»åŠ åˆ°é¡µé¢
  
  // è‡ªåŠ¨ç§»é™¤toast
  if (duration > 0) {
    setTimeout(() => removeToast(toast), duration);  // è®¾ç½®è‡ªåŠ¨ç§»é™¤æ—¶é—´
  }
}

// OCRæ ‡ç­¾é¡µåˆå§‹åŒ–å‡½æ•°
function initializeOCRTab() {
  const ocrUpload = document.getElementById('ocr-upload');      // æ–‡ä»¶ä¸Šä¼ å…ƒç´ 
  const ocrPreview = document.getElementById('ocr-preview');    // å›¾ç‰‡é¢„è§ˆå…ƒç´ 
  const ocrRecognize = document.getElementById('ocr-recognize'); // è¯†åˆ«æŒ‰é’®
  const ocrResult = document.getElementById('ocr-result');      // ç»“æœæ˜¾ç¤ºå…ƒç´ 
  
  // æ–‡ä»¶ä¸Šä¼ å¤„ç†
  ocrUpload.addEventListener('change', async (e) => {
    const file = e.target.files[0];  // è·å–é€‰æ‹©çš„æ–‡ä»¶
    if (file) {
      try {
        // æ–‡ä»¶å¤§å°æ£€æŸ¥
        if (file.size > 16 * 1024 * 1024) {  // 16MBé™åˆ¶
          throw new Error('æ–‡ä»¶å¤§å°ä¸èƒ½è¶…è¿‡16MB');
        }
        
        // æ–‡ä»¶ç±»å‹æ£€æŸ¥
        if (!file.type.startsWith('image/')) {  // éªŒè¯æ˜¯å¦ä¸ºå›¾ç‰‡æ–‡ä»¶
          throw new Error('è¯·é€‰æ‹©å›¾ç‰‡æ–‡ä»¶');
        }
        
        const base64 = await fileToBase64(file);  // è½¬æ¢ä¸ºbase64æ ¼å¼
        currentImages.ocr = base64;               // ä¿å­˜åˆ°å…¨å±€å˜é‡
        
        // æ˜¾ç¤ºé¢„è§ˆ
        ocrPreview.innerHTML = `<img src="data:image/jpeg;base64,${base64}" alt="ä¸Šä¼ çš„å›¾ç‰‡">`;
        ocrRecognize.disabled = false;            // å¯ç”¨è¯†åˆ«æŒ‰é’®
        
        showToast(`å›¾ç‰‡ä¸Šä¼ æˆåŠŸï¼š${file.name} (${(file.size / 1024).toFixed(1)}KB)`, 'success');
        
      } catch (error) {
        showToast('å›¾ç‰‡ä¸Šä¼ å¤±è´¥ï¼š' + error.message, 'error');
      }
    }
  });
  
  // OCRè¯†åˆ«å¤„ç†
  ocrRecognize.addEventListener('click', async () => {
    if (!currentImages.ocr) {  // æ£€æŸ¥æ˜¯å¦å·²ä¸Šä¼ å›¾ç‰‡
      showToast('è¯·å…ˆä¸Šä¼ å›¾ç‰‡', 'error');
      return;
    }
    
    const selectedEngine = document.querySelector('input[name="ocr-engine"]:checked').value;  // è·å–é€‰æ‹©çš„å¼•æ“
    
    // æ£€æŸ¥é€‰æ‹©çš„å¼•æ“æ˜¯å¦å¯ç”¨
    if (!enginesStatus[selectedEngine] || !enginesStatus[selectedEngine].available) {
      showToast(`${enginesStatus[selectedEngine]?.name || selectedEngine} å¼•æ“ä¸å¯ç”¨ï¼Œè¯·æ£€æŸ¥æ˜¯å¦å·²æ­£ç¡®å®‰è£…`, 'error');
      return;
    }
    
    // æ˜¾ç¤ºåŠ è½½çŠ¶æ€
    ocrResult.innerHTML = '<div class="loading-spinner"></div>æ­£åœ¨è¯†åˆ«æ–‡å­—...';
    ocrResult.className = 'result-box loading';
    
    try {
      // å‘é€APIè¯·æ±‚
      const response = await fetch('/api/ocr-simple', {
        method: 'POST',
        headers: {
          'Content-Type': 'application/json'
        },
        body: JSON.stringify({
          image: currentImages.ocr,  // å‘é€base64å›¾åƒæ•°æ®
          engine: selectedEngine     // å‘é€é€‰æ‹©çš„å¼•æ“
        })
      });
      
      const data = await response.json();  // è§£æå“åº”æ•°æ®
      
      if (data.success) {
        // æ˜¾ç¤ºè¯†åˆ«ç»“æœ
        const resultHtml = `
          <div class="ocr-result-summary">
            <h4>OCRè¯†åˆ«ç»“æœ (${data.engine})</h4>
            <div class="text-result">
              <strong>è¯†åˆ«æ–‡æœ¬:</strong><br>
              <span class="recognized-text">${data.text}</span>
            </div>
            <div class="confidence-info">
              <strong>ç½®ä¿¡åº¦:</strong> 
              <span class="confidence ${data.confidence > 0.7 ? 'high' : data.confidence > 0.4 ? 'medium' : 'low'}">
                ${(data.confidence * 100).toFixed(1)}%
              </span>
            </div>
          </div>
        `;
        
        ocrResult.innerHTML = resultHtml;     // æ˜¾ç¤ºç»“æœHTML
        ocrResult.className = 'result-box success';  // è®¾ç½®æˆåŠŸæ ·å¼
        showToast('OCRè¯†åˆ«å®Œæˆï¼', 'success');
        
      } else {
        throw new Error(data.error || 'è¯†åˆ«å¤±è´¥');
      }
      
    } catch (error) {
      ocrResult.textContent = 'è¯†åˆ«å¤±è´¥ï¼š' + error.message;  // æ˜¾ç¤ºé”™è¯¯ä¿¡æ¯
      ocrResult.className = 'result-box error';             // è®¾ç½®é”™è¯¯æ ·å¼
      showToast('OCR è¯†åˆ«å¤±è´¥ï¼š' + error.message, 'error');
    }
  });
}
```

    - **æ¨¡å—åŒ–åˆå§‹åŒ–**ï¼šé€šè¿‡`initializeOCRTab`, `initializePlateTab`ç­‰å‡½æ•°ï¼Œå¯¹æ¯ä¸ªåŠŸèƒ½é¢æ¿çš„äº‹ä»¶ç›‘å¬å™¨è¿›è¡Œç‹¬ç«‹åˆå§‹åŒ–ï¼Œä»£ç ç»“æ„æ¸…æ™°ã€‚
    - **å¼‚æ­¥é€šä¿¡**ï¼šæ‰€æœ‰ä¸åç«¯çš„äº¤äº’å‡é€šè¿‡`fetch` APIå¼‚æ­¥å®Œæˆï¼Œé¿å…é¡µé¢åˆ·æ–°ï¼Œæå‡ç”¨æˆ·ä½“éªŒã€‚
    - **åŠ¨æ€åé¦ˆ**ï¼šåœ¨APIè¯·æ±‚æœŸé—´ï¼Œç•Œé¢ä¼šæ˜¾ç¤ºåŠ è½½åŠ¨ç”»ï¼Œå¹¶ç¦ç”¨ç›¸å…³æŒ‰é’®ã€‚è¯·æ±‚ç»“æŸåï¼Œæ ¹æ®è¿”å›ç»“æœï¼ˆæˆåŠŸæˆ–å¤±è´¥ï¼‰é€šè¿‡`showToast`å‡½æ•°å¼¹å‡ºæ¶ˆæ¯æç¤ºï¼Œå¹¶å°†ç»“æœåŠ¨æ€æ¸²æŸ“åˆ°é¡µé¢ä¸Šã€‚
    - **å¼•æ“çŠ¶æ€åŒæ­¥**ï¼šé¡µé¢åŠ è½½æ—¶ï¼Œä¼šå…ˆè¯·æ±‚`/api/ocr-engines`æ¥å£ï¼Œè·å–å¼•æ“çŠ¶æ€ï¼Œå¹¶åŠ¨æ€æ›´æ–°UIï¼ˆå¦‚ç¦ç”¨ä¸å¯ç”¨å¼•æ“çš„é€‰é¡¹ï¼‰ã€‚

4.3. **æ ¸å¿ƒåŠŸèƒ½å®ç°ç»†èŠ‚**

- **è½¦ç‰Œè¯†åˆ«å¢å¼º**ï¼šåœ¨è°ƒç”¨HyperLPR3æˆ–PaddleOCRä¹‹å‰ï¼Œä¼šå…ˆè°ƒç”¨`enhance_image_for_ocr`å‡½æ•°ã€‚è¯¥å‡½æ•°ç»¼åˆè¿ç”¨OpenCVçš„å¤šç§æŠ€æœ¯ï¼ˆå¦‚ç°åº¦åŒ–ã€å¯¹æ¯”åº¦å¢å¼ºCLAHEã€é”åŒ–ï¼‰å¯¹å›¾åƒè¿›è¡Œé¢„å¤„ç†ï¼Œæ˜¾è‘—æé«˜äº†åœ¨å¤æ‚å…‰ç…§æˆ–ä½åˆ†è¾¨ç‡æ¡ä»¶ä¸‹è½¦ç‰Œè¯†åˆ«çš„æˆåŠŸç‡å’Œå‡†ç¡®æ€§ã€‚

- **ä½ç½®ä¿¡åº¦å¤„ç†**ï¼šå¯¹äºHyperLPR3è¿”å›çš„ä½ç½®ä¿¡åº¦ç»“æœï¼Œç³»ç»Ÿä¸ä¼šç›´æ¥ä¸¢å¼ƒï¼Œè€Œæ˜¯å°†å…¶æ ‡è®°ä¸ºâ€œä½ç½®ä¿¡åº¦å€™é€‰â€ï¼Œå¹¶é™ä½å…¶æƒé‡ï¼ŒåŒæ—¶åœ¨ç»“æœä¸­ç»™äºˆç”¨æˆ·æç¤ºã€‚è¿™ç§è®¾è®¡å…¼é¡¾äº†å¬å›ç‡å’Œå‡†ç¡®ç‡ã€‚

================================================================================
5. å®éªŒæµ‹è¯•ä¸ç»“æœåˆ†æ
================================================================================

- **åŠŸèƒ½æµ‹è¯•**ï¼š
    - **ç™»å½•æ¨¡å—**ï¼šæµ‹è¯•äº†ç®¡ç†å‘˜è´¦å·ï¼ˆadmin/adminï¼‰çš„ç™»å½•ã€ç™»å‡ºåŠŸèƒ½ï¼Œä»¥åŠæœªç™»å½•çŠ¶æ€ä¸‹è®¿é—®å—ä¿æŠ¤é¡µé¢çš„è‡ªåŠ¨è·³è½¬ï¼Œå‡ç¬¦åˆé¢„æœŸã€‚
    - **å›¾åƒä¸Šä¼ **ï¼šæ”¯æŒæ‹–æ‹½å’Œç‚¹å‡»ä¸Šä¼ ï¼Œå¯æ­£å¸¸å¤„ç†`jpg`, `png`ç­‰æ ¼å¼çš„å›¾ç‰‡ã€‚
    - **è½¦ç‰Œè¯†åˆ«**ï¼šä½¿ç”¨`test_real_images.py`ä¸­çš„å¤šå¼ çœŸå®åœºæ™¯å›¾ç‰‡è¿›è¡Œæµ‹è¯•ã€‚ç»“æœè¡¨æ˜ï¼ŒHyperLPR3å¯¹æ¸…æ™°è½¦ç‰Œçš„è¯†åˆ«ç‡è¾¾åˆ°95%ä»¥ä¸Šã€‚å¯¹äºæ¨¡ç³Šæˆ–æœ‰é®æŒ¡çš„è½¦ç‰Œï¼Œå¤šå¼•æ“ååŒæœºåˆ¶èƒ½å¤Ÿæœ‰æ•ˆè¡¥å……ï¼ŒPaddleOCRèƒ½è¯†åˆ«å‡ºéƒ¨åˆ†HyperLPR3å¤±è´¥çš„æ¡ˆä¾‹ã€‚
    - **å›¾åƒå¤„ç†**ï¼šæ‰€æœ‰OpenCVå¤„ç†åŠŸèƒ½å‡èƒ½æ­£ç¡®åº”ç”¨å¹¶å®æ—¶é¢„è§ˆã€‚

- **æ€§èƒ½åˆ†æ**ï¼š
    - åœ¨æœ¬åœ°æµ‹è¯•ç¯å¢ƒä¸‹ï¼Œå•å¼ å›¾ç‰‡ï¼ˆ~1MBï¼‰çš„å¹³å‡APIå“åº”æ—¶é—´ï¼š
        - **HyperLPR3**ï¼šçº¦ 200-400msã€‚
        - **PaddleOCR**ï¼šçº¦ 400-700msã€‚
        - **Tesseract/EasyOCR**ï¼šçº¦ 500-1000msã€‚
    - æ™ºèƒ½è°ƒåº¦æœºåˆ¶çš„æœ‰æ•ˆæ€§ï¼šå½“ä½¿ç”¨é«˜ç½®ä¿¡åº¦å›¾ç‰‡æ—¶ï¼Œç³»ç»Ÿé€šå¸¸åœ¨ç¬¬ä¸€ä¸ªå¼•æ“ï¼ˆHyperLPR3ï¼‰è°ƒç”¨åå³è¿”å›ç»“æœï¼Œæ€»è€—æ—¶è¾ƒä½ã€‚

- **é”™è¯¯å¤„ç†æµ‹è¯•**ï¼š
    - **å¼•æ“ä¸å¯ç”¨**ï¼šæ‰‹åŠ¨ç§»é™¤`hyperlpr3`åº“åï¼Œå‰ç«¯èƒ½æ­£ç¡®åœ°ä»APIè·å–åˆ°å…¶ä¸å¯ç”¨çŠ¶æ€ï¼Œå¹¶ç¦ç”¨ç›¸å…³åŠŸèƒ½ã€‚æ­¤æ—¶è¿›è¡Œè¯†åˆ«ï¼Œç³»ç»Ÿä¼šè‡ªåŠ¨è·³è¿‡è¯¥å¼•æ“ï¼Œè°ƒç”¨åç»­çš„PaddleOCRç­‰ï¼Œæµç¨‹æ­£å¸¸ã€‚
    - **æ— æ•ˆå›¾ç‰‡**ï¼šä¸Šä¼ éå›¾ç‰‡æ–‡ä»¶æˆ–æŸåçš„å›¾ç‰‡æ–‡ä»¶ï¼Œåç«¯èƒ½æ­£ç¡®æ•è·å¼‚å¸¸å¹¶è¿”å›`400 Bad Request`é”™è¯¯ï¼Œå‰ç«¯åˆ™ä¼šæ˜¾ç¤ºå‹å¥½çš„é”™è¯¯æç¤ºã€‚

================================================================================
6. ç»“è®ºä¸æ€»ç»“
================================================================================

æœ¬æ¬¡å®éªŒæˆåŠŸæ„å»ºäº†ä¸€ä¸ªåŠŸèƒ½å¼ºå¤§ä¸”è®¾è®¡å®Œå–„çš„æ™ºèƒ½è½¦ç‰Œè¯†åˆ«ç³»ç»Ÿã€‚ç³»ç»Ÿçš„ä¸»è¦åˆ›æ–°ç‚¹å’Œä¼˜åŠ¿åœ¨äºï¼š

1.  **å¤šå¼•æ“ååŒä¸æ™ºèƒ½å®¹é”™**ï¼šé€šè¿‡æ™ºèƒ½è°ƒåº¦å’Œä¼˜å…ˆçº§ç®¡ç†ï¼Œæœ€å¤§åŒ–äº†å„ç§åœºæ™¯ä¸‹çš„è¯†åˆ«æˆåŠŸç‡ï¼Œè¿œä¼˜äºå•ä¸€å¼•æ“æ–¹æ¡ˆã€‚
2.  **å‰åç«¯åˆ†ç¦»ä¸æ¨¡å—åŒ–è®¾è®¡**ï¼šæ¸…æ™°çš„æ¶æ„ä½¿å¾—ç³»ç»Ÿæ˜“äºç»´æŠ¤å’Œæ‰©å±•ã€‚ä¾‹å¦‚ï¼Œæœªæ¥å¯ä»¥æ–¹ä¾¿åœ°é›†æˆæ–°çš„AIå¼•æ“æˆ–æ·»åŠ æ–°çš„å›¾åƒå¤„ç†åŠŸèƒ½ã€‚
3.  **æ³¨é‡ç”¨æˆ·ä½“éªŒ**ï¼šä»å“åº”å¼å¸ƒå±€ã€å®æ—¶åé¦ˆåˆ°è¯¦ç»†çš„é”™è¯¯æç¤ºï¼Œå‰ç«¯è®¾è®¡å¤„å¤„ä½“ç°äº†ä»¥ç”¨æˆ·ä¸ºä¸­å¿ƒçš„æ€æƒ³ã€‚

é€šè¿‡æœ¬æ¬¡å®éªŒï¼Œä¸ä»…æŒæ¡äº†Flaskã€OpenCVç­‰æ ¸å¿ƒåº“çš„åº”ç”¨ï¼Œæ›´åœ¨ç³»ç»Ÿæ¶æ„è®¾è®¡ã€å¤šæŠ€æœ¯æ•´åˆã€é¡¹ç›®å·¥ç¨‹åŒ–ç­‰æ–¹é¢å¾—åˆ°äº†æ·±å…¥çš„é”»ç‚¼ã€‚è¯¥é¡¹ç›®å·²è¾¾åˆ°é¢„æœŸçš„è®¾è®¡ç›®æ ‡ï¼Œå…·å¤‡äº†ä½œä¸ºå®é™…åº”ç”¨çš„åŸºç¡€ã€‚
